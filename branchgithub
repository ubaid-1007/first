this code is very difficult
